<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BlookDash | Version 26.0</title>
    <style>
        :root {
            --primary: #3498db; --dark-bg: #0b101b; --sidebar-bg: #161d2b;
            --card-bg: #1c2331; --danger: #e74c3c; --success: #2ecc71;
            --warning: #f1c40f; --chroma: #00FBFF; --exclusive: #ff0000;
            --epic: #a335ee; --legendary: #ff8000; --rare: #0070dd; --common: #ffffff;
        }

        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Segoe UI', sans-serif; background: var(--dark-bg); color: white; overflow: hidden; }

        /* --- SPLASH SCREEN --- */
        #splash-screen { position: fixed; width: 100%; height: 100%; background: radial-gradient(circle, #1c2331, #000); z-index: 30000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .bubble-text { font-size: 100px; font-weight: 900; color: var(--primary); text-shadow: 5px 5px 0px #fff, 10px 10px 25px rgba(0,0,0,0.7); letter-spacing: 8px; margin-bottom: 40px; font-family: 'Arial Rounded MT Bold', sans-serif; animation: float 3s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
        .splash-btn { padding: 20px 50px; font-size: 24px; margin: 15px; border-radius: 50px; border: none; cursor: pointer; font-weight: bold; transition: 0.3s; width: 250px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .splash-btn:hover { transform: scale(1.1); }

        /* --- UI LAYOUT --- */
        #sidebar { width: 240px; background: var(--sidebar-bg); height: 100vh; display: flex; flex-direction: column; padding: 20px; border-right: 2px solid #2c3e50; float: left; box-sizing: border-box; }
        .nav-btn { background: none; border: none; color: #bdc3c7; text-align: left; padding: 12px; font-size: 18px; cursor: pointer; border-radius: 8px; margin-bottom: 8px; width: 100%; transition: 0.2s; }
        .nav-btn.active { background: var(--primary); color: white; }
        #main-content { margin-left: 240px; padding: 40px; height: 100vh; overflow-y: auto; box-sizing: border-box; }

        /* --- CARDS --- */
        .pack-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; }
        .pack-card { background: var(--sidebar-bg); padding: 25px; border-radius: 20px; text-align: center; border: 2px solid #2c3e50; cursor: pointer; transition: 0.3s; }
        .pack-card:hover { transform: translateY(-5px); border-color: var(--primary); box-shadow: 0 10px 20px rgba(0,0,0,0.4); }

        /* --- MODALS --- */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 20000; align-items: center; justify-content: center; flex-direction: column; }
        #auth-screen { position:fixed; width:100%; height:100%; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.85); z-index:25000; }
        
        #game-canvas { background: #70c5ce; border: 6px solid #161d2b; border-radius: 20px; display: block; margin: 20px auto; cursor: pointer; }
    </style>
</head>
<body onload="init()">

    <div id="splash-screen">
        <div class="bubble-text">BlookDash</div>
        <button class="splash-btn" style="background:var(--success); color:white;" onclick="showAuth()">SIGN UP</button>
        <button class="splash-btn" style="background:var(--primary); color:white;" onclick="showAuth()">LOGIN</button>
    </div>

    <div id="auth-screen">
        <div style="background:var(--sidebar-bg); padding:40px; border-radius:20px; width:350px; text-align:center; border:3px solid var(--primary);">
            <h2>Account Access</h2>
            <input type="text" id="user-input" style="width:100%; padding:12px; margin:15px 0; background:#000; color:#fff; border:1px solid #444; border-radius:5px;" placeholder="Username">
            <button onclick="auth()" class="nav-btn" style="background:var(--primary); color:white; width:100%; text-align:center; font-weight:bold;">ENTER DASH</button>
        </div>
    </div>

    <div id="game-ui" style="display:none;">
        <div id="sidebar">
            <h2 style="color:var(--primary)">BlookDash</h2>
            <button class="nav-btn active" onclick="tab('market', this)">üõí Market</button>
            <button class="nav-btn" onclick="tab('community', this)">üë• Community Shop</button>
            <button class="nav-btn" onclick="tab('collection', this)">üéí Collection</button>
            <button class="nav-btn" onclick="tab('game-center', this)">üïπÔ∏è Game Center</button>
            <div style="margin-top:auto;">
                <p style="font-size:12px; color:#888;">BALANCE</p>
                <b id="stat-tokens" style="color:var(--warning); font-size:18px; word-break: break-all;">0</b>
                <button onclick="location.reload()" class="nav-btn" style="background:var(--danger); color:white; text-align:center; margin-top:15px;">Logout</button>
            </div>
        </div>

        <div id="main-content">
            <div id="market" class="tab">
                <h1>Market</h1>
                <div id="pack-list" class="pack-grid"></div>
            </div>

            <div id="community" class="tab" style="display:none;">
                <h1>Community Shop</h1>
                <div style="background:var(--card-bg); padding:25px; border-radius:20px; margin-bottom:30px; border:2px dashed var(--primary);">
                    <h3>List a New Blook</h3>
                    <div style="display:flex; gap:10px; flex-wrap:wrap;">
                        <input type="text" id="custom-name" placeholder="Name" style="padding:10px; border-radius:5px; flex:1;">
                        <input type="text" id="custom-img" placeholder="Emoji" style="padding:10px; border-radius:5px; width:60px;">
                        <input type="number" id="custom-price" placeholder="Price" style="padding:10px; border-radius:5px; width:120px;">
                        <button onclick="createCommunityBlook()" class="nav-btn" style="background:var(--success); color:white; width:auto; padding:0 20px;">Post Listing</button>
                    </div>
                </div>
                <div id="community-list" class="pack-grid"></div>
            </div>

            <div id="collection" class="tab" style="display:none;">
                <h1>My Collection</h1>
                <div id="blook-list" class="pack-grid"></div>
            </div>

            <div id="game-center" class="tab" style="display:none; text-align: center;">
                <h1>Game Center</h1>
                <div style="display:flex; justify-content:center; gap:40px;">
                    <h2>Score: <span id="f-score">0</span></h2>
                    <h2 style="color:var(--success)">Earned: <span id="f-earned">0</span></h2>
                </div>
                <canvas id="game-canvas" width="400" height="450"></canvas>
                <button onclick="resetGame()" class="nav-btn" style="background:var(--primary); width: 220px; margin: 10px auto; text-align:center;">Reset & Play</button>
            </div>
        </div>
    </div>

    <div id="reveal-modal" class="modal">
        <div id="reveal-card" style="text-align:center;">
            <div id="reveal-img" style="font-size:150px;"></div>
            <h2 id="reveal-name" style="font-size:45px; margin:10px 0;"></h2>
            <p id="reveal-rarity" style="font-size:25px; font-weight:bold; letter-spacing:2px;"></p>
        </div>
        <button onclick="closeModal()" class="nav-btn" style="background:var(--primary); color:white; width:200px; margin-top:50px; font-weight:bold;">COLLECT</button>
    </div>

    <script>
        let user = null;
        let data = { tokens: 5000n, inventory: [] };
        let communityBlooks = []; 
        const DEC = 10n ** 33n;

        const packs = [
            { name: 'Medieval Pack', icon: 'üè∞', cost: 1000n, pool: [
                {name:'Peasant', rarity:'Common', img:'üë®‚Äçüåæ'}, {name:'Squire', rarity:'Common', img:'üõ°Ô∏è'}, 
                {name:'Knight', rarity:'Rare', img:'ü§∫'}, {name:'Archer', rarity:'Rare', img:'üèπ'},
                {name:'Wizard', rarity:'Epic', img:'üßô'}, {name:'King', rarity:'Legendary', img:'üëë'},
                {name:'The Dragon', rarity:'Chroma', img:'üêâ'}
            ]},
            { name: 'Shark Pack', icon: 'ü¶à', cost: 1000n, pool: [
                {name:'Reef Shark', rarity:'Common', img:'üêü'}, {name:'Mako Shark', rarity:'Rare', img:'ü¶à'}, 
                {name:'Hammerhead Shark', rarity:'Epic', img:'üî®'}, {name:'Great White Shark', rarity:'Legendary', img:'ü¶à'},
                {name:'Megalodon', rarity:'Chroma', img:'ü¶ñ'}
            ]},
            { name: 'Roman Pack', icon: 'üèõÔ∏è', cost: 1000n, pool: [
                {name:'Roman Soldier', rarity:'Common', img:'üíÇ'}, {name:'Centurion', rarity:'Rare', img:'üéñÔ∏è'}, 
                {name:'Gladiator', rarity:'Epic', img:'‚öîÔ∏è'}, {name:'Julius Caesar', rarity:'Legendary', img:'üèõÔ∏è'},
                {name:'Mars', rarity:'Chroma', img:'‚òÑÔ∏è'}
            ]},
            { name: 'Aquatic Pack', icon: 'üåä', cost: 1000n, pool: [
                {name:'Clownfish', rarity:'Common', img:'üê†'}, {name:'Sea Turtle', rarity:'Rare', img:'üê¢'}, 
                {name:'Giant Squid', rarity:'Epic', img:'ü¶ë'}, {name:'Blue Whale', rarity:'Legendary', img:'üêã'},
                {name:'Kraken', rarity:'Chroma', img:'üêô'}
            ]},
            { name: 'Science Pack', icon: 'üß™', cost: 1000n, pool: [
                {name:'Beaker', rarity:'Common', img:'üß™'}, {name:'Microscope', rarity:'Rare', img:'üî¨'}, 
                {name:'DNA Helix', rarity:'Epic', img:'üß¨'}, {name:'Albert Einstein', rarity:'Legendary', img:'üë®‚Äçüè´'},
                {name:'The Atom', rarity:'Chroma', img:'‚öõÔ∏è'}
            ]},
            { name: 'Exclusive Pack', icon: 'üíé', cost: DEC, pool: [
                {name:'Jandul Dul Dul', rarity:'Exclusive', img:'ü§°'},
                {name:'Raccooni Jandelini', rarity:'Exclusive', img:'ü¶ù'}
            ]}
        ];

        function showAuth() { document.getElementById('auth-screen').style.display = 'flex'; }

        function auth() {
            const u = document.getElementById('user-input').value.trim();
            if(!u) return;
            user = u;
            const saved = JSON.parse(localStorage.getItem('bd_'+u));
            if(saved) data = { tokens: BigInt(saved.tokens), inventory: saved.inventory };
            document.getElementById('splash-screen').style.display = 'none';
            document.getElementById('auth-screen').style.display = 'none';
            document.getElementById('game-ui').style.display = 'block';
            renderPacks(); updateUI();
        }

        function renderPacks() {
            document.getElementById('pack-list').innerHTML = packs.map((p, i) => `
                <div class="pack-card" onclick="buyPack(${i})">
                    <div style="font-size:60px;">${p.icon}</div>
                    <h3>${p.name}</h3><p>${p.cost >= DEC ? '1 Decillion' : p.cost.toLocaleString()} Tokens</p>
                </div>`).join('');
        }

        function buyPack(i) {
            const p = packs[i];
            if(data.tokens < p.cost) return alert("Insufficient balance!");
            data.tokens -= p.cost;
            const res = p.pool[Math.floor(Math.random()*p.pool.length)];
            data.inventory.unshift({...res});
            save(); updateUI(); showReveal(res);
        }

        function createCommunityBlook() {
            const n = document.getElementById('custom-name').value;
            const im = document.getElementById('custom-img').value;
            const pr = BigInt(document.getElementById('custom-price').value || 0);
            if(!n || !im || pr <= 0n) return alert("Fill all fields correctly!");
            communityBlooks.push({ name: n, img: im, cost: pr, rarity: 'Community', seller: user });
            renderCommunity();
            alert("Blook Listed!");
        }

        function renderCommunity() {
            document.getElementById('community-list').innerHTML = communityBlooks.map((b, i) => `
                <div class="pack-card" onclick="buyCommunity(${i})">
                    <div style="font-size:50px;">${b.img}</div>
                    <b>${b.name}</b><br><small>By: ${b.seller}</small>
                    <p style="color:var(--warning); font-weight:bold;">${b.cost.toLocaleString()} Tokens</p>
                </div>`).join('');
        }

        function buyCommunity(i) {
            const b = communityBlooks[i];
            if(data.tokens < b.cost) return alert("Not enough tokens!");
            data.tokens -= b.cost;
            data.inventory.unshift({...b});
            save(); updateUI(); alert("You bought " + b.name);
        }

        function tab(id, btn) {
            document.querySelectorAll('.tab').forEach(t => t.style.display='none');
            document.getElementById(id).style.display='block';
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            if(id === 'collection') renderInv();
            if(id === 'community') renderCommunity();
        }

        function renderInv() {
            document.getElementById('blook-list').innerHTML = data.inventory.map(b => `
                <div class="pack-card">
                    <div style="font-size:50px;">${b.img}</div><b>${b.name}</b><br><small>${b.rarity}</small>
                </div>`).join('');
        }

        function showReveal(b) {
            const colors = { Common:'#fff', Rare:'#0070dd', Epic:'#a335ee', Legendary:'#ff8000', Chroma:'#00FBFF', Exclusive:'#ff0000' };
            document.getElementById('reveal-modal').style.display = 'flex';
            document.getElementById('reveal-img').innerText = b.img;
            document.getElementById('reveal-name').innerText = b.name;
            document.getElementById('reveal-rarity').innerText = b.rarity;
            document.getElementById('reveal-rarity').style.color = colors[b.rarity] || '#fff';
        }

        function save() { if(user) localStorage.setItem('bd_'+user, JSON.stringify({tokens:data.tokens.toString(), inventory:data.inventory})); }
        function updateUI() { document.getElementById('stat-tokens').innerText = data.tokens.toLocaleString(); }
        function closeModal() { document.getElementById('reveal-modal').style.display='none'; }

        /* --- FLAPPY ENGINE --- */
        const cvs = document.getElementById('game-canvas');
        const ctx = cvs.getContext('2d');
        let bird, pipes, score, earned, active = false;

        function resetGame() {
            bird = { x: 50, y: 200, v: 0, g: 0.22, j: -4.5, s: 25 };
            pipes = []; score = 0; earned = 0; active = true;
            document.getElementById('f-score').innerText = "0";
            document.getElementById('f-earned').innerText = "0";
        }

        function gameLoop() {
            if(active) {
                bird.v += bird.g; bird.y += bird.v;
                if(pipes.length === 0 || pipes[pipes.length-1].x < 220) {
                    let gap = 140, top = Math.random() * (cvs.height - gap - 100) + 50;
                    pipes.push({ x: cvs.width, t: top, b: top + gap, passed: false });
                }
                pipes.forEach((p, i) => {
                    p.x -= 3;
                    if(p.x + 50 < 0) pipes.splice(i,1);
                    if(!p.passed && bird.x > p.x + 50) { 
                        p.passed = true; score++; earned += 100;
                        document.getElementById('f-score').innerText = score;
                        document.getElementById('f-earned').innerText = earned;
                        data.tokens += 100n; updateUI(); 
                    }
                    if(bird.x + bird.s > p.x && bird.x < p.x + 50 && (bird.y < p.t || bird.y + bird.s > p.b)) active = false;
                });
                if(bird.y > cvs.height || bird.y < 0) active = false;
                if(!active) save(); 
            }
            ctx.clearRect(0,0, cvs.width, cvs.height);
            ctx.fillStyle = "#f1c40f"; ctx.fillRect(bird.x, bird.y, bird.s, bird.s);
            ctx.fillStyle = "#2ecc71";
            pipes.forEach(p => { ctx.fillRect(p.x, 0, 50, p.t); ctx.fillRect(p.x, p.b, 50, cvs.height - p.b); });
            requestAnimationFrame(gameLoop);
        }

        window.addEventListener('keydown', e => { 
            if(e.code === 'Space' && active) bird.v = bird.j; 
            if(e.ctrlKey && e.shiftKey && e.key === 'O') { data.tokens += 1000000n; updateUI(); }
        });
        cvs.addEventListener('mousedown', () => { if(active) bird.v = bird.j; });
        function init() { gameLoop(); }
    </script>
</body>
</html>
