<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BlookDash | 24.0</title>
    <style>
        :root {
            --primary: #3498db; --dark-bg: #0b101b; --sidebar-bg: #161d2b;
            --card-bg: #1c2331; --danger: #e74c3c; --success: #2ecc71;
            --warning: #f1c40f; --chroma: #00FBFF;
        }

        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Segoe UI', sans-serif; background: var(--dark-bg); color: white; overflow: hidden; }

        /* --- UI LAYOUT --- */
        #sidebar { width: 240px; background: var(--sidebar-bg); height: 100vh; display: flex; flex-direction: column; padding: 20px; border-right: 2px solid #2c3e50; float: left; box-sizing: border-box; }
        #main-content { margin-left: 240px; padding: 40px; height: 100vh; overflow-y: auto; box-sizing: border-box; }
        .nav-btn { background: none; border: none; color: #bdc3c7; text-align: left; padding: 12px; font-size: 18px; cursor: pointer; border-radius: 8px; margin-bottom: 8px; width: 100%; transition: 0.2s; }
        .nav-btn.active { background: var(--primary); color: white; }
        .nav-btn:hover { background: rgba(255,255,255,0.1); }

        /* --- GAME CENTER --- */
        #flappy-container { display: none; position: relative; background: #70c5ce; border: 4px solid white; border-radius: 15px; margin: 20px auto; overflow: hidden; width: 600px; height: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        #game-over { position: absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); display:none; flex-direction:column; align-items:center; justify-content:center; z-index: 10; }

        /* --- MARKET & ANIMATIONS --- */
        .pack-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; }
        .pack-card { background: var(--sidebar-bg); padding: 20px; border-radius: 15px; text-align: center; border: 2px solid #2c3e50; cursor: pointer; transition: 0.2s; }
        @keyframes blookPop { 0% { transform: scale(0); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        .animate-pop { animation: blookPop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

        /* --- OWNER PANEL --- */
        #owner-panel { position: fixed; bottom: 20px; right: 20px; background: rgba(0,0,0,0.9); border: 2px solid var(--warning); padding: 15px; border-radius: 10px; display: none; z-index: 50000; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 20000; flex-direction: column; align-items: center; justify-content: center; }
    </style>
</head>
<body onload="init()">

    <div id="auth-screen" style="position:fixed; width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:var(--dark-bg); z-index:10000;">
        <div style="background:var(--sidebar-bg); padding:40px; border-radius:20px; width:300px; text-align:center;">
            <h1>BlookDash</h1>
            <input type="text" id="user-input" placeholder="Username" style="width:100%; padding:10px; margin:10px 0;">
            <input type="password" id="pass-input" placeholder="Password" style="width:100%; padding:10px; margin:10px 0;">
            <button onclick="auth('login')" class="nav-btn" style="background:var(--primary); color:white; text-align:center;">Login</button>
            <button onclick="auth('signup')" class="nav-btn" style="background:var(--success); color:white; text-align:center;">Sign Up</button>
            <button onclick="fixAgentFox()" style="background:none; border:none; color:gray; cursor:pointer; text-decoration:underline; font-size:12px; margin-top:10px;">Fix AgentFox212 Password</button>
        </div>
    </div>

    <div id="game-ui" style="display:none;">
        <div id="sidebar">
            <h2>BlookDash</h2>
            <button class="nav-btn active" onclick="tab('market', this)">üõí Market</button>
            <button class="nav-btn" onclick="tab('games', this)">üéÆ Game Center</button>
            <button class="nav-btn" onclick="tab('collection', this)">üéí Collection</button>
            <button class="nav-btn" onclick="tab('settings', this)">‚öôÔ∏è Settings</button>
            <div style="margin-top:auto;">
                <p>Tokens: <b id="stat-tokens" style="color:var(--warning);">0</b></p>
                <button onclick="location.reload()" class="nav-btn" style="background:var(--danger); color:white; text-align:center;">Logout</button>
            </div>
        </div>

        <div id="main-content">
            <div id="market" class="tab">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h1>Market</h1>
                    <label><input type="checkbox" id="spam-open"> Spam Open</label>
                </div>
                <div id="pack-list" class="pack-grid"></div>
            </div>

            <div id="games" class="tab" style="display:none;">
                <h1>Game Center</h1>
                <div class="pack-card" onclick="startFlappy()" style="width:200px;">üê¶ Flappy Blook</div>
                <div id="flappy-container">
                    <canvas id="flappyCanvas" width="600" height="400"></canvas>
                    <div id="game-over">
                        <h2>GAME OVER</h2>
                        <p id="tokens-won">Tokens: 0</p>
                        <button onclick="startFlappy()" class="nav-btn" style="background:var(--success); color:white; width:150px; text-align:center;">Retry</button>
                    </div>
                </div>
            </div>

            <div id="collection" class="tab" style="display:none;">
                <h1>Collection</h1>
                <div id="blook-list" class="pack-grid"></div>
            </div>

            <div id="settings" class="tab" style="display:none;">
                <h1>Settings</h1>
                <button onclick="deleteAcc()" style="background:var(--danger); color:white; padding:10px; border:none; border-radius:5px;">DELETE ACCOUNT</button>
            </div>
        </div>
    </div>

    <div id="open-modal" class="modal">
        <div id="blook-reveal" class="animate-pop" style="text-align:center;">
            <div id="reveal-img" style="font-size:100px;"></div>
            <h2 id="reveal-name"></h2>
            <p id="reveal-rarity"></p>
        </div>
        <button onclick="closeModal()" class="nav-btn" style="background:var(--primary); color:white; width:150px; text-align:center; margin-top:30px;">Collect</button>
    </div>

    <div id="owner-panel">
        <h3 style="color:var(--warning);">Owner Mode</h3>
        <button onclick="addTokens(1000000)">+1M Tokens</button>
    </div>

    <script>
        let user = null, data = { tokens: 50000, inventory: [{name:'Dog', img:'üê∂', rarity:'Common'}] };
        
        function fixAgentFox() {
            let foxData = localStorage.getItem('bd_AgentFox212');
            if(foxData) {
                let d = JSON.parse(foxData);
                d.pass = "3Pasword3";
                localStorage.setItem('bd_AgentFox212', JSON.stringify(d));
                alert("AgentFox212 password fixed to: 3Pasword3");
            } else {
                alert("Account AgentFox212 not found on this device.");
            }
        }

        function auth(mode) {
            const u = document.getElementById('user-input').value.trim();
            const p = document.getElementById('pass-input').value.trim();
            if(!u) return;
            if(mode === 'signup') {
                localStorage.setItem('bd_'+u, JSON.stringify({pass:"3Pasword3", tokens:50000, inventory:[]}));
                alert("Created! Password is 3Pasword3");
            } else {
                const saved = JSON.parse(localStorage.getItem('bd_'+u));
                if(saved && saved.pass === p) { user = u; data = saved; launch(); }
                else alert("Error! Check password.");
            }
        }

        function launch() {
            document.getElementById('auth-screen').style.display = 'none';
            document.getElementById('game-ui').style.display = 'block';
            renderPacks(); updateUI();
        }

        function renderPacks() {
            const packs = [
                { name: 'Shark Pack', cost: 1000, icon: 'ü¶à', pool: [{name:'Megalodon', rarity:'Chroma', img:'ü¶à'}] },
                { name: 'Peppermint Pack', cost: 5000, icon: 'üç¨', pool: [{name:'Minty', rarity:'Legendary', img:'üç≠'}] }
            ];
            document.getElementById('pack-list').innerHTML = packs.map(p => `
                <div class="pack-card" onclick="openPack(${JSON.stringify(p).replace(/"/g, '&quot;')})">
                    <div style="font-size:40px">${p.icon}</div>
                    <h3>${p.name}</h3><p>${p.cost} Tokens</p>
                </div>
            `).join('');
        }

        function openPack(pack) {
            if(data.tokens < pack.cost) return alert("Not enough tokens!");
            data.tokens -= pack.cost;
            const res = pack.pool[0]; 
            data.inventory.push(res);
            save(); updateUI();
            if(!document.getElementById('spam-open').checked) {
                document.getElementById('open-modal').style.display = 'flex';
                document.getElementById('reveal-img').innerText = res.img;
                document.getElementById('reveal-name').innerText = res.name;
                document.getElementById('reveal-rarity').innerText = res.rarity;
            }
        }

        function tab(id, btn) {
            document.querySelectorAll('.tab').forEach(t => t.style.display='none');
            document.getElementById(id).style.display='block';
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            if(id === 'collection') renderInv();
            if(id !== 'games') stopFlappy();
        }

        function renderInv() {
            document.getElementById('blook-list').innerHTML = data.inventory.map(b => `
                <div class="pack-card">
                    <div style="font-size:40px">${b.img}</div><b>${b.name}</b>
                </div>
            `).join('');
        }

        // --- SMOOTH FLAPPY BIRD ENGINE ---
        let cvs = document.getElementById('flappyCanvas'), ctx = cvs.getContext('2d'), bird, pipes, gRun = false, score = 0;
        
        function startFlappy() {
            document.getElementById('flappy-container').style.display = 'block';
            document.getElementById('game-over').style.display = 'none';
            const b = data.inventory[Math.floor(Math.random()*data.inventory.length)] || {img:'üê¶'};
            bird = {x:60, y:200, v:0, g:0.4, lift:-7, img:b.img, angle:0};
            pipes = []; score = 0; gRun = true;
            pipes.push(genPipe());
            loop();
        }

        function genPipe() {
            const isPep = Math.random() < 0.2;
            const h = Math.random() * 180 + 50;
            return { x: 600, top: h, gap: 130, isPep: isPep, passed: false };
        }

        function loop() {
            if(!gRun) return;
            ctx.fillStyle = '#70c5ce'; ctx.fillRect(0,0,600,400);
            
            // Bird Physics
            bird.v += bird.g; bird.y += bird.v;
            bird.angle = Math.min(Math.PI/4, Math.max(-Math.PI/4, bird.v * 0.1));

            ctx.save();
            ctx.translate(bird.x + 20, bird.y + 20);
            ctx.rotate(bird.angle);
            ctx.font = "40px Arial";
            ctx.fillText(bird.img, -20, 15);
            ctx.restore();

            if(bird.y > 380 || bird.y < -20) gRun = false;

            pipes.forEach(p => {
                p.x -= 2.5; // Slightly slower for less glitchy feel
                ctx.fillStyle = p.isPep ? "#ff4d4d" : "#2ecc71";
                ctx.fillRect(p.x, 0, 50, p.top);
                ctx.fillRect(p.x, p.top + p.gap, 50, 400);

                if(bird.x + 30 > p.x && bird.x < p.x + 50) {
                    if(bird.y < p.top || bird.y + 30 > p.top + p.gap) gRun = false;
                }

                if(!p.passed && p.x < bird.x) {
                    p.passed = true;
                    let reward = p.isPep ? 1000 : 100;
                    score += reward; data.tokens += reward;
                    updateUI();
                }
            });

            if(pipes[pipes.length-1].x < 350) pipes.push(genPipe());
            if(pipes[0].x < -60) pipes.shift();

            if(!gRun) {
                document.getElementById('game-over').style.display = 'flex';
                document.getElementById('tokens-won').innerText = "Earned: " + score;
                save();
            } else {
                requestAnimationFrame(loop);
            }
        }

        window.onkeydown = (e) => { if(e.key === ' ' && gRun) bird.v = bird.lift; };
        cvs.onclick = () => { if(gRun) bird.v = bird.lift; };

        function updateUI() { document.getElementById('stat-tokens').innerText = data.tokens.toLocaleString(); }
        function save() { if(user) localStorage.setItem('bd_'+user, JSON.stringify(data)); }
        function closeModal() { document.getElementById('open-modal').style.display = 'none'; }
        function deleteAcc() { if(confirm("Delete?")) { localStorage.removeItem('bd_'+user); location.reload(); } }
        function init() {}
        function addTokens(n) { data.tokens += n; updateUI(); save(); }
        
        window.addEventListener('keydown', e => {
            if(e.ctrlKey && e.shiftKey && e.key === 'O') {
                document.getElementById('owner-panel').style.display = 'block';
            }
        });
    </script>
</body>
</html>
